
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Basics &#8212; Spinguin 0.0.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=f131489c"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'basics';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://nmroulu.github.io/Spinguin/latest/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.0.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spinguin" href="spinguin.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/spinguin_logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/spinguin_logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">Spinguin documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Basics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="spinguin.html">Spinguin</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequences.html">Sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Internal classes</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/basics.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Basics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-parameters">Global parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-spin-system">Creating a spin system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-basis-set">Building a basis set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-spin-system-properties">Defining spin system properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-relaxation-theory">Define the relaxation theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-the-pulse-and-acquire-experiment">Performing the pulse-and-acquire experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-the-fid">Visualising the FID</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtaining-the-spectrum">Obtaining the spectrum</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="basics">
<span id="id1"></span><h1>Basics<a class="headerlink" href="#basics" title="Link to this heading">#</a></h1>
<p>Spinguin is meant to be easy to use, even for those who are not very familiar
with Python nor spin dynamics simulations. The package is designed to for
running spin dynamics simulations in liquid state. The main features of
Spinguin are:</p>
<ul class="simple">
<li><p>Versatile numerical spin-dynamics simulations in liquid state.</p></li>
<li><p>Support for restricted basis sets, enabling the use of large spin systems
with more than 10 spins on consumer-level hardware.</p></li>
<li><p>Simulation of coherent dynamics, relaxation, and chemical exchange processes.</p></li>
</ul>
<p>Below, the main functionality of Spinguin is introduced by simulating a simple
NMR spectrum of a pyridine molecule.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h2>
<p>Spinguin is designed to be used directly under the <code class="docutils literal notranslate"><span class="pre">spinguin</span></code> namespace. To
start, simply import the package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">spinguin</span> <span class="k">as</span> <span class="nn">sg</span>
</pre></div>
</div>
<p>You can then access its functionality through the <code class="docutils literal notranslate"><span class="pre">sg</span></code> namespace. For the
available functionality, please refer to <a class="reference internal" href="spinguin.html#spinguin"><span class="std std-ref">Spinguin</span></a>.</p>
</section>
<section id="global-parameters">
<h2>Global parameters<a class="headerlink" href="#global-parameters" title="Link to this heading">#</a></h2>
<p>Spinguin makes use of global parameters that can be set to control the behavior
of the simulations. These parameters can be set by calling
<code class="docutils literal notranslate"><span class="pre">sg.parameters.PARAMETERNAME</span></code> after importing the package. For example, to set
the magnetic field and temperature, you can use the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sg</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">magnetic_field</span> <span class="o">=</span> <span class="mf">9.4</span>
<span class="n">sg</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">295</span>
</pre></div>
</div>
<p>Essentially, the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> is an instance of <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> class, and the
behaviour of the Spinguin package can be managed by changing the attributes of
the object. For the available parameters, please refer to the <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>
class in <a class="reference internal" href="internals.html#internals"><span class="std std-ref">Internal classes</span></a>.</p>
</section>
<section id="creating-a-spin-system">
<h2>Creating a spin system<a class="headerlink" href="#creating-a-spin-system" title="Link to this heading">#</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">SpinSystem</span></code> is the core of any spin dynamics simulation in Spinguin. It
represents a collection of spins, to which properties, such as chemical shifts,
<em>J</em>-coupling constants, and relaxation rates can be assigned.</p>
<p>You can create a spin system by providing a list of spin types (e.g., ‘1H’,
‘13C’, etc.) to the <code class="docutils literal notranslate"><span class="pre">SpinSystem</span></code> class. The spin types are specified as
strings, and you can include as many spins as needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">SpinSystem</span><span class="p">([</span><span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="s1">&#39;1H&#39;</span><span class="p">,</span> <span class="s1">&#39;14N&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="building-a-basis-set">
<h2>Building a basis set<a class="headerlink" href="#building-a-basis-set" title="Link to this heading">#</a></h2>
<p>Simulations in Spinguin are performed in Liouville space using the Kronecker
products of irreducible spherical tensors (ISTs) as the basis set. This allows
the use of a restricted basis set, which is essential for simulating large spin
systems efficiently.</p>
<p>To build the basis, you must first define the maximum spin order that is going
to be used in the basis. This is specified as an attribute to the basis of the
<code class="docutils literal notranslate"><span class="pre">SpinSystem</span></code> instance. Next, you can call the <code class="docutils literal notranslate"><span class="pre">build_basis()</span></code> method to
build the basis set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">max_spin_order</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">spin_system</span><span class="o">.</span><span class="n">basis</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">basis</span></code> is an instance of <code class="docutils literal notranslate"><span class="pre">Basis</span></code> class which is automatically assigned
as an attribute to the <code class="docutils literal notranslate"><span class="pre">SpinSystem</span></code> object. Other functionality available in
the <code class="docutils literal notranslate"><span class="pre">Basis</span></code> class is documented in <a class="reference internal" href="internals.html#internals"><span class="std std-ref">Internal classes</span></a>.</p>
</section>
<section id="defining-spin-system-properties">
<h2>Defining spin system properties<a class="headerlink" href="#defining-spin-system-properties" title="Link to this heading">#</a></h2>
<p>The properties of the spin system are assigned as attributes to the system.</p>
<p>First, we are going to assign the chemical shifts to the spin system created
above. The chemical shifts are specified as a list of floats in the units of ppm
(parts per million):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span><span class="o">.</span><span class="n">chemical_shifts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">8.56</span><span class="p">,</span> <span class="mf">8.56</span><span class="p">,</span> <span class="mf">7.47</span><span class="p">,</span> <span class="mf">7.47</span><span class="p">,</span> <span class="mf">7.88</span><span class="p">,</span> <span class="mf">95.94</span><span class="p">]</span>
</pre></div>
</div>
<p>Next, we assign the <em>J</em>-coupling constants. These are given as a two-dimensional
list in the units of Hz:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span><span class="o">.</span><span class="n">J_couplings</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.04</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">4.85</span><span class="p">,</span>  <span class="mf">1.05</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.05</span><span class="p">,</span>  <span class="mf">4.85</span><span class="p">,</span>   <span class="mf">0.71</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">1.24</span><span class="p">,</span>  <span class="mf">1.24</span><span class="p">,</span>   <span class="mf">7.55</span><span class="p">,</span>   <span class="mf">7.55</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mf">8.16</span><span class="p">,</span>  <span class="mf">8.16</span><span class="p">,</span>   <span class="mf">0.87</span><span class="p">,</span>   <span class="mf">0.87</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.19</span><span class="p">,</span>   <span class="mi">0</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="define-the-relaxation-theory">
<h2>Define the relaxation theory<a class="headerlink" href="#define-the-relaxation-theory" title="Link to this heading">#</a></h2>
<p>The goal is to simulate the NMR spectrum of pyridine. Therefore, relaxation must
be defined. We use the <cite>phenomenological</cite> relaxation here, <cite>i.e.</cite>, we give the
relaxation times to the software.</p>
<p>First, the relaxation theory must be defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span><span class="o">.</span><span class="n">relaxation</span><span class="o">.</span><span class="n">theory</span> <span class="o">=</span> <span class="s2">&quot;phenomenological&quot;</span>
</pre></div>
</div>
<p>Then, the relaxation times in seconds can be given as a list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_system</span><span class="o">.</span><span class="n">relaxation</span><span class="o">.</span><span class="n">T1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]</span>
<span class="n">spin_system</span><span class="o">.</span><span class="n">relaxation</span><span class="o">.</span><span class="n">T2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0002</span><span class="p">]</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">relaxation</span></code> is an instance of <code class="docutils literal notranslate"><span class="pre">RelaxationProperties</span></code> class, which
is used to store the relaxation-theory settigns. The other available settings
are documented in the class description in <a class="reference internal" href="internals.html#internals"><span class="std std-ref">Internal classes</span></a>.</p>
</section>
<section id="performing-the-pulse-and-acquire-experiment">
<h2>Performing the pulse-and-acquire experiment<a class="headerlink" href="#performing-the-pulse-and-acquire-experiment" title="Link to this heading">#</a></h2>
<p>Once the global parameters, spin system, basis set, spin system properties, and
relaxation theory have been defined, the simulations can be performed. We
simulate the NMR spectrum using the pulse-and-acquire experiment. The available
pulse sequences are documented in <a class="reference internal" href="sequences.html#sequences"><span class="std std-ref">Sequences</span></a> and are accessible by
<code class="docutils literal notranslate"><span class="pre">sg.sequences.SEQUENCENAME</span></code>. The pulse-and-acquire experiment requires five
additional parameters to be defined:</p>
<ul class="simple">
<li><p>isotope</p></li>
<li><p>center frequency (ppm)</p></li>
<li><p>number of points</p></li>
<li><p>dwell time (s)</p></li>
<li><p>pulse angle</p></li>
</ul>
<p>Next, we define these parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">isotope</span> <span class="o">=</span> <span class="s2">&quot;1H&quot;</span>
<span class="n">center_frequency</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">npoints</span> <span class="o">=</span> <span class="mi">12500</span>
<span class="n">dwell_time</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">90</span>
</pre></div>
</div>
<p>Finally, we perform the experiment, which outputs the free induction decay:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fid</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">pulse_and_acquire</span><span class="p">(</span>
    <span class="n">spin_system</span> <span class="o">=</span> <span class="n">spin_system</span><span class="p">,</span>
    <span class="n">isotope</span> <span class="o">=</span> <span class="n">isotope</span><span class="p">,</span>
    <span class="n">center_frequency</span> <span class="o">=</span> <span class="n">center_frequency</span><span class="p">,</span>
    <span class="n">npoints</span> <span class="o">=</span> <span class="n">npoints</span><span class="p">,</span>
    <span class="n">dwell_time</span> <span class="o">=</span> <span class="n">dwell_time</span><span class="p">,</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Congratulations! You have now sucessfully performed a spin dynamics simulation
using Spinguin.</p>
</section>
<section id="visualising-the-fid">
<h2>Visualising the FID<a class="headerlink" href="#visualising-the-fid" title="Link to this heading">#</a></h2>
<p>We plot the results using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. First, make sure that <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>
is installed and then import the package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Next, calculate the time axis using the number of points and dwell time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_axis</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">time_axis</span><span class="p">(</span><span class="n">npoints</span><span class="p">,</span> <span class="n">dwell_time</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can plot the FID:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_axis</span><span class="p">,</span> <span class="n">fid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity (arb. units)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="obtaining-the-spectrum">
<h2>Obtaining the spectrum<a class="headerlink" href="#obtaining-the-spectrum" title="Link to this heading">#</a></h2>
<p>The ultimate goal is to plot the NMR spectrum of pyridine, which is obtained by
performing the Fourier transform. The Fourier transform returns the frequencies
and their corresponding intensities. The frequencies are converted to the ppm
scale:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">freqs</span><span class="p">,</span> <span class="n">spec</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">fid</span><span class="p">,</span> <span class="n">dwell_time</span><span class="p">)</span>
<span class="n">shift_axis</span> <span class="o">=</span> <span class="n">freqs</span><span class="o">/</span><span class="n">sg</span><span class="o">.</span><span class="n">resonance_frequency</span><span class="p">(</span><span class="n">isotope</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="o">+</span> <span class="n">center_frequency</span>
</pre></div>
</div>
<p>Finally, we plot the spectrum of pyridine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shift_axis</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Chemical shift (ppm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity (arb. units)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">8.8</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
<p>Congratulations! You have now successfully simulated and plotted the NMR
spectrum of pyridine.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="spinguin.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Spinguin</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-parameters">Global parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-spin-system">Creating a spin system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-a-basis-set">Building a basis set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-spin-system-properties">Defining spin system properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-relaxation-theory">Define the relaxation theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-the-pulse-and-acquire-experiment">Performing the pulse-and-acquire experiment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualising-the-fid">Visualising the FID</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obtaining-the-spectrum">Obtaining the spectrum</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Joni Eronen, Perttu Hilla
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Joni Eronen, Perttu Hilla.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>